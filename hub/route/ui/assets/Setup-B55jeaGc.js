import{u as A,a as B,b as T,c as q,o as z,e as u,d as p,f as H,i as c,B as $,I as M,F as N,g as X,t as E,z as f,h as U,s as b,j as G,k as _,l as J,m as K,v as O,n as Q}from"./index-BNWZoS7C.js";import{D as W}from"./DocumentTitle-DoomuBUS.js";const l=[];for(let t=0;t<256;++t)l.push((t+256).toString(16).slice(1));function Y(t,n=0){return(l[t[n+0]]+l[t[n+1]]+l[t[n+2]]+l[t[n+3]]+"-"+l[t[n+4]]+l[t[n+5]]+"-"+l[t[n+6]]+l[t[n+7]]+"-"+l[t[n+8]]+l[t[n+9]]+"-"+l[t[n+10]]+l[t[n+11]]+l[t[n+12]]+l[t[n+13]]+l[t[n+14]]+l[t[n+15]]).toLowerCase()}let w;const Z=new Uint8Array(16);function tt(){if(!w){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");w=crypto.getRandomValues.bind(crypto)}return w(Z)}const et=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),S={randomUUID:et};function nt(t,n,y){if(S.randomUUID&&!n&&!t)return S.randomUUID();t=t||{};const r=t.random||(t.rng||tt)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Y(r)}var st=E('<div class="mx-auto flex max-w-screen-sm flex-col items-center gap-4 py-10"><form class=contents><div class="flex w-full flex-col gap-4"><div class=flex-1><label class=label><span class=label-text></span></label><input name=url type=url class="input input-bordered w-full"placeholder=http(s)://{hostname}:{port} list=defaultEndpoints><datalist id=defaultEndpoints></datalist></div><div class=flex-1><label class=label><span class=label-text></span></label><input name=secret type=password class="input input-bordered w-full"placeholder=secret></div></div></form><div class="grid w-full grid-cols-2 gap-4">'),lt=E('<div class="badge badge-info flex w-full cursor-pointer items-center justify-between gap-4 py-4"><span class=truncate>');const at=f.object({url:f.string().min(1),secret:f.string()}),ot=()=>{const[t]=A(),n=B(),y=T(),r=s=>{_(s),y("/overview",{replace:!0})},C=async s=>{const e=u().find(a=>a.id===s);e&&await U(e.url,e.secret)&&r(s)},g=async({url:s,secret:e})=>{const a=K(s);if(!await U(a,e))return;const i=nt(),o=u().slice(),d=o.find(h=>h.url===a);if(!d){b([{id:i,url:a,secret:e},...o]),r(i);return}d.secret=e,d.id=i,b(o),r(i)},R=s=>{const{message:e}=s;Q.error(e)},{form:v}=q({extend:O({schema:at}),onSubmit:g,onError:R}),I=s=>{G()===s&&_(""),b(u().filter(e=>e.id!==s))};return z(async()=>{var a,i;const s=n.search||window.location.search||((i=(a=n.hash.match(/\?.*$/))==null?void 0:a[0])==null?void 0:i.replace("?",""));if(!s)return;const e=new URLSearchParams(s);e.has("hostname")?await g({url:`${e.get("http")?"http:":e.get("https")?"https:":window.location.protocol}//${e.get("hostname")}${e.get("port")?`:${e.get("port")}`:""}`,secret:e.get("secret")??""}):u().length===0&&await g({url:"http://127.0.0.1:9090",secret:""})}),[p(W,{get children(){return t("setup")}}),(()=>{var s=st(),e=s.firstChild,a=e.firstChild,i=a.firstChild,o=i.firstChild,d=o.firstChild,h=o.nextSibling,L=i.nextSibling,D=L.firstChild,k=D.firstChild,j=e.nextSibling;return H(v,e,()=>v),c(d,()=>t("endpointURL")),c(k,()=>t("secret")),c(a,p($,{type:"submit",class:"btn-primary uppercase",get children(){return t("add")}}),null),c(j,p(N,{get each(){return u()},children:({id:x,url:V})=>(()=>{var m=lt(),F=m.firstChild;return m.$$click=()=>C(x),c(F,V),c(m,p($,{class:"btn-circle btn-ghost btn-xs text-white",onClick:P=>{P.stopPropagation(),I(x)},get children(){return p(M,{})}}),null),m})()})),X(()=>h.value=window.location.origin),s})()]};J(["click"]);export{ot as default};
